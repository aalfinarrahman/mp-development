<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MP Development Management System</title>
    <link rel="stylesheet" href="css/style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <!-- Comment atau hapus baris ini: -->
    <!-- <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2"></script> -->
    <script src="js/auth.js"></script>
    <head>
        <link rel="icon" type="image/x-icon" href="/favicon.ico">
        <!-- or use a PNG file -->
        <link rel="icon" type="image/png" href="assets/icons/factory-icon.png">
        <!-- atau -->
        <link rel="icon" type="image/x-icon" href="assets/icons/favicon.ico">
    </head>
</body>
<body>
    <div class="container">
        <!-- Sidebar -->
        <nav class="sidebar">
            <div class="logo">
                <h3>MP Development Management System</h3>
                <p style="font-size: 15x; opacity: 0.8; margin-top: 5px;">Comp Assy & Comp WClutch</p>
            </div>
            <ul class="nav-menu">
                <li class="nav-item">
                    <a href="#" class="nav-link active" data-section="dashboard">
                        <i>üìä</i> Dashboard
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link" data-section="database">
                        <i>üë•</i> Database MP
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link" data-section="end-contract">
                        <i>üìã</i> End Contract
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link" data-section="recruitment">
                        <i>üéØ</i> Recruitment
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link" data-section="education">
                        <i>üéì</i> Edukasi
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link" data-section="education-schedule">
                        <i>üìÖ</i> Jadwal Edukasi
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link" data-section="mapping">
                        <i>üó∫Ô∏è</i> Mapping MP
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link" data-section="skill-matrix">
                        <i>üìä</i> Skill Matriks
                    </a>
                </li>
                <li class="nav-item" style="border-top: 1px solid rgba(255,255,255,0.1); margin-top: 20px; padding-top: 20px;">
                    <a href="#" class="nav-link" data-section="settings">
                        <i>‚öôÔ∏è</i> Settings
                    </a>
                </li>
            </ul>
        </nav>

        <!-- Main Content -->
        <main class="main-content">
            <header class="header">
                <h1 id="page-title">Dashboard</h1>
                <div class="user-info">
                    <span>Welcome, Admin</span>
                    <div class="user-avatar">A</div>
                </div>
            </header>

            <!-- Dashboard Section -->
            <section id="dashboard-section" class="content-section">
                <!-- Enhanced Stats Cards - langsung tanpa welcome banner -->
                <div class="dashboard-grid">
                    <div class="stat-card stat-card-blue">
                        <div class="stat-icon">üë•</div>
                        <div class="stat-content">
                            <h3>Total Man Power Aktif</h3>
                            <div class="number">0</div>
                            <div class="change">Belum ada data</div>
                        </div>
                    </div>
                    <div class="stat-card stat-card-green">
                        <div class="stat-icon">‚úÖ</div>
                        <div class="stat-content">
                            <h3>MP End Contract</h3>
                            <div class="number">0</div>
                            <div class="change">Bulan Ini</div>
                        </div>
                    </div>
                    <div class="stat-card stat-card-orange">
                        <div class="stat-icon">üìã</div>
                        <div class="stat-content">
                            <h3>MP Recruitment</h3>
                            <div class="number">0</div>
                            <div class="change">Bulan Ini</div>
                        </div>
                    </div>
                    <div class="stat-card stat-card-purple">
                        <div class="stat-icon">üéØ</div>
                        <div class="stat-content">
                            <h3>MP Edukasi</h3>
                            <div class="number" id="educationStatNumber">0</div>
                            <div class="change" id="educationStatChange">Bulan Ini</div>
                        </div>
                    </div>
                </div>

                <!-- Charts Grid dengan layout yang lebih baik -->
                <div class="charts-container">
                    <!-- End Contract Charts -->
                    <div class="chart-section">
                        <h2 class="section-title">üìä Monitoring MP End Contract</h2>
                        <div class="charts-grid">
                            <!-- Grafik 1: MP End Contract - Comp Assy -->
                            <div class="chart-card">
                                <div class="chart-header">
                                    <h3 class="chart-title">üìä MP End Contract - Comp Assy</h3>
                                    <div class="chart-filter">
                                        <label for="endContractCompAssyYearFilter">üìÖ Filter Tahun:</label>
                                        <select id="endContractCompAssyYearFilter" onchange="updateEndContractCompAssyChart()">
                                            <!-- Options will be populated by JavaScript -->
                                        </select>
                                    </div>
                                </div>
                                <canvas id="endContractCompAssyChart"></canvas>
                            </div>
                            
                            <!-- Grafik 2:  MP End Contract - Comp WClutch -->
                            <div class="chart-card">
                                <div class="chart-header">
                                    <h3 class="chart-title">üìä  MP End Contract - Comp WClutch</h3>
                                    <div class="chart-filter">
                                        <label for="endContractCompWClutchYearFilter">üìÖ Filter Tahun:</label>
                                        <select id="endContractCompWClutchYearFilter" onchange="updateEndContractCompWClutchChart()">
                                            <!-- Options will be populated by JavaScript -->
                                        </select>
                                    </div>
                                </div>
                                <canvas id="endContractCompWClutchChart"></canvas>
                            </div>
                        </div>
                        
                        <!-- Education Charts -->
                        <div class="chart-section">
                            <h2 class="section-title">üéì Monitoring MP Edukasi</h2>
                            <div class="charts-grid">
                                <!-- Grafik 3: MP Edukasi - Comp Assy -->
                                <div class="chart-card">
                                    <div class="chart-header">
                                        <h3 class="chart-title">üéì MP Edukasi - Comp Assy</h3>
                                        <div class="chart-filter">
                                            <label for="educationCompAssyYearFilter">üìÖ Filter Tahun:</label>
                                            <select id="educationCompAssyYearFilter" onchange="updateEducationCompAssyChart()">
                                                <!-- Options will be populated by JavaScript -->
                                            </select>
                                        </div>
                                    </div>
                                    <canvas id="educationCompAssyChart"></canvas>
                                </div>
                                
                                <!-- Grafik 4: MP Edukasi - Comp WClutch -->
                                <div class="chart-card">
                                    <div class="chart-header">
                                        <h3 class="chart-title">üéì MP Edukasi - Comp WClutch</h3>
                                        <div class="chart-filter">
                                            <label for="educationCompWClutchYearFilter">üìÖ Filter Tahun:</label>
                                            <select id="educationCompWClutchYearFilter" onchange="updateEducationCompWClutchChart()">
                                                <!-- Options will be populated by JavaScript -->
                                            </select>
                                        </div>
                                    </div>
                                    <canvas id="educationCompWClutchChart"></canvas>
                                </div>
                        </div>
                        
                        <!-- Attendance Chart -->
                        <div class="chart-section">
                            <h2 class="section-title">üìà Monitoring Jadwal & Kehadiran</h2>
                            <div class="charts-grid-single">
                                <!-- Grafik 3: Monitoring Jadwal & Kehadiran Edukasi Harian -->
                                <div class="chart-card chart-card-wide">
                                    <div class="chart-header">
                                        <h3 class="chart-title">üìà Monitoring Jadwal & Kehadiran Edukasi Harian</h3>
                                        <div class="chart-filter">
                                            <label for="attendanceMonthFilter">üìÖ Filter Bulan:</label>
                                            <select id="attendanceMonthFilter" onchange="updateAttendanceChart()">
                                                <option value="0">Januari</option>
                                                <option value="1">Februari</option>
                                                <option value="2">Maret</option>
                                                <option value="3">April</option>
                                                <option value="4">Mei</option>
                                                <option value="5">Juni</option>
                                                <option value="6">Juli</option>
                                                <option value="7">Agustus</option>
                                                <option value="8">September</option>
                                                <option value="9">Oktober</option>
                                                <option value="10">November</option>
                                                <option value="11">Desember</option>
                                            </select>
                                            <label for="attendanceYearFilter">üìÖ Tahun:</label>
                                            <select id="attendanceYearFilter" onchange="updateAttendanceChart()">
                                                <!-- Options will be populated by JavaScript -->
                                            </select>
                                            <label for="attendanceSectionFilter">üè≠ Section:</label>
                                            <select id="attendanceSectionFilter" onchange="updateAttendanceChart()">
                                                <option value="all">Semua Section</option>
                                                <option value="Comp Assy">Comp Assy</option>
                                                <option value="Comp WClutch">Comp WClutch</option>
                                            </select>
                                        </div>
                                    </div>
                                    <canvas id="attendanceChart"></canvas>
                                </div>
                        </div>
                    </div>
            </section>

            <!-- Database MP Section -->
            <section id="database-section" class="content-section hidden">
                <div class="section-header">
                    <h2>üë• Database Manpower</h2>
                </div>
                <div class="table-container">
                    <div class="table-header">
                        <div class="button-group">
                            <button class="btn btn-primary" onclick="openModal('add')">
                                <span>+</span> Tambah Karyawan
                            </button>
                            <button class="btn btn-success" onclick="exportToCSV()">
                                <span>üìä</span> Export CSV
                            </button>
                        </div>
                        <div class="search-box">
                            <input type="text" placeholder="       Cari karyawan..." id="searchInput">
                        </div>
                    </div>
                    <table id="employeeTable">
                        <thead>
                            <tr>
                                <th class="sortable" onclick="toggleNPKSort()">NPK <span id="sort-indicator">‚Üë</span></th>
                                <th>Nama</th>
                                <th>Gender</th>
                                <th>Section</th>
                                <th>Line</th>
                                <th>Leader</th>
                                <th>Date In</th>
                                <th>Status</th>
                                <th>Tipe</th>
                                <th>Function</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody id="employeeTableBody">
                            <!-- Data will be loaded from localStorage -->
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- End Contract Section -->
            <section id="end-contract-section" class="content-section hidden">
                <div class="section-header">
                    <h2>üìã Data MP End Contract</h2>
                </div>
                <div class="table-container">
                    <!-- Ganti struktur filter di tab End Contract (sekitar baris 285-310) -->
                    <div class="table-header">
                        <button class="btn btn-primary" onclick="openEndContractModal()">+ Tambah Data</button>
                        <div class="chart-filter">
                            <label for="endContractMonthFilter">üìÖ Filter Bulan:</label>
                            <select id="endContractMonthFilter" onchange="filterEndContractByMonth()">
                                <option value="">Semua Bulan</option>
                                <option value="01">Januari</option>
                                <option value="02">Februari</option>
                                <option value="03">Maret</option>
                                <option value="04">April</option>
                                <option value="05">Mei</option>
                                <option value="06">Juni</option>
                                <option value="07">Juli</option>
                                <option value="08">Agustus</option>
                                <option value="09">September</option>
                                <option value="10">Oktober</option>
                                <option value="11">November</option>
                                <option value="12">Desember</option>
                            </select>
                            
                            <label for="endContractYearFilter">üìÖ Filter Tahun:</label>
                            <select id="endContractYearFilter" onchange="filterEndContractByMonth()">
                                <option value="">Semua Tahun</option>
                                <!-- Options akan diisi oleh JavaScript -->
                            </select>
                        </div>
                        <div class="search-box">
                            <input type="text" placeholder="      Cari data end contract..." id="endContractSearchInput">
                        </div>
                    </div>
                    <table id="endContractTable">
                        <thead>
                            <tr>
                                <th class="sortable" onclick="toggleEndContractNPKSort()">NPK <span id="end-contract-sort-indicator">‚Üë</span></th>
                                <th>Nama</th>
                                <th>Gender</th>
                                <th>Section</th>
                                <th>Line</th>
                                <th>Leader</th>
                                <th>Date In</th>
                                <th>Durasi</th>
                                <th>Date Out</th>
                                <th>Alasan</th>
                                <th>Status</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody id="endContractTableBody">
                            <!-- Data will be loaded from localStorage -->
                        </tbody>
                    </table>
                </div>
            </section>

<!-- Recruitment Section -->
<section id="recruitment-section" class="content-section hidden">
    <div class="section-header">
        <h2>Data MP Recruitment</h2>
    </div>
    <div class="table-container">
        <div class="table-header">
            <div class="chart-filter">
                <label for="recruitmentMonthFilter">üìÖ Filter Bulan:</label>
                <select id="recruitmentMonthFilter" onchange="filterRecruitmentData()">
                    <option value="all">Semua Bulan</option>
                    <option value="01">Januari</option>
                    <option value="02">Februari</option>
                    <option value="03">Maret</option>
                    <option value="04">April</option>
                    <option value="05">Mei</option>
                    <option value="06">Juni</option>
                    <option value="07">Juli</option>
                    <option value="08">Agustus</option>
                    <option value="09">September</option>
                    <option value="10">Oktober</option>
                    <option value="11">November</option>
                    <option value="12">Desember</option>
                </select>
                
                <label for="recruitmentYearFilter">üìÜ Filter Tahun:</label>
                <select id="recruitmentYearFilter" onchange="filterRecruitmentData()">
                    <option value="all">Semua Tahun</option>
                    <!-- Years will be populated by JavaScript -->
                </select>
            </div>
            <div class="search-box">
                <input type="text" id="recruitmentSearch" placeholder="      Cari kandidat..." onkeyup="filterRecruitmentData()">
            </div>
        </div>

        <table class="data-table">
            <thead>
                <tr>
                    <th colspan="3" style="background-color: #e67e22; color: white;">Data dari MP End (Otomatis)</th>
                    <th colspan="8" style="background-color: #3498db; color: white;">Data dari Database MP (Manual)</th>
                    <th rowspan="2">Actions</th>
                </tr>
                <tr>
                    <th style="background-color: #fff8dc;">NPK</th>
                    <th style="background-color: #fff8dc;">Nama</th>
                    <th style="background-color: #fff8dc;">Date Out</th>
                    <th style="background-color: #f0f8ff;">NPK</th>
                    <th style="background-color: #f0f8ff;">Nama</th>
                    <th style="background-color: #f0f8ff;">Gender</th>
                    <th style="background-color: #f0f8ff;">Section</th>
                    <th style="background-color: #f0f8ff;">Line</th>
                    <th style="background-color: #f0f8ff;">Leader</th>
                    <th style="background-color: #f0f8ff;">Date In</th>
                    <th style="background-color: #f0f8ff;">Rekomendasi</th>
                </tr>
            </thead>
            <tbody id="recruitmentTableBody">
                <!-- Data will be loaded by JavaScript -->
            </tbody>
        </table>
    </div>
</section>

            <!-- Education Section -->
            <section id="education-section" class="content-section hidden">
                <div class="section-header">
                    <h2>üéì Data MP Edukasi</h2>
                    <div class="education-filter">
                        <label for="educationDateFilter">üìÖ Filter Tanggal:</label>
                        <input type="date" id="educationDateFilter" onchange="filterEducationByDate()">
                        <button class="btn btn-secondary" onclick="clearEducationDateFilter()">Clear</button>
                        
                        <label for="educationMonthYearFilter">üìÖ Filter Bulan:</label>
                        <select id="educationMonthYearFilter" onchange="filterEducationByMonth()">
                            <option value="all">Semua Periode</option>
                            <!-- Options will be populated by JavaScript -->
                        </select>
                    </div>
                </div>
                <div class="table-container">
                    <div class="table-header">
                        <button class="btn btn-primary" onclick="openModal('education')">
                            <span>+</span> Tambah Program Edukasi
                        </button>
                        <div class="search-box">
                            <input type="text" placeholder="      Cari program edukasi...">
                        </div>
                    </div>
                    <table>
                        <thead>
                            <tr>
                                <th>No</th>
                                <th>NPK</th>
                                <th>Name</th>
                                <th>Section</th>
                                <th>Line</th>
                                <th>Leader</th>
                                <th>Nama Pos</th>
                                <th>Category</th>
                                <th>Date Education</th>
                                <th>Date Planning</th>
                                <th>Raport</th>
                                <th>Status</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody id="educationTableBody">
                            <!-- Data will be loaded from localStorage -->
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Education Schedule Section -->
            <section id="education-schedule-section" class="content-section hidden">
                <div class="section-header">
                    <h2>üìÖ Jadwal Edukasi Harian</h2>
                    <div class="education-filter">
                        <label for="scheduleDateFilter">üìÖ Filter Tanggal:</label>
                        <input type="date" id="scheduleDateFilter" onchange="filterEducationScheduleByDate()">
                        <button class="btn btn-secondary" onclick="clearDateFilter()">Clear</button>
                        <label for="scheduleMonthYearFilter">üìÖ Filter Bulan:</label>
                        <select id="scheduleMonthYearFilter" onchange="filterEducationSchedule()">
                            <option value="all">Semua Periode</option>
                            <!-- Options will be populated by JavaScript (e.g., Mei-25, Jun-25) -->
                        </select>
                    </div>
                </div>
                <div class="table-container">
                    <div class="table-header">
                        <div class="quick-filters">
                            <button class="btn btn-sm btn-info" onclick="setQuickDateFilter(0)">Hari Ini</button>
                            <button class="btn btn-sm btn-warning" onclick="setQuickDateFilter(1)">Besok</button>
                            <button class="btn btn-sm btn-secondary" onclick="setQuickDateFilter(7)">Minggu Depan</button>
                        </div>
                        <div class="search-box">
                            <input type="text" id="scheduleSearchInput" placeholder="        Cari jadwal edukasi..." onkeyup="searchEducationSchedule()">
                        </div>
                    </div>
                    <table>
                        <!-- In education schedule section -->
                        <thead>
                            <tr>
                                <th>No</th>
                                <th>NPK</th>
                                <th>Name</th>
                                <th>Section</th>
                                <th>Line</th>
                                <th>Leader</th>
                                <th>Category</th>
                                <th>Nama Pos</th>
                                <th>Date</th>
                                <th>Time</th>
                                <th>Status</th>
                                <th>Note</th>
                            </tr>
                        </thead>
                        <tbody id="educationScheduleTableBody">
                            <!-- Data will be loaded from localStorage -->
                        </tbody>
                    </table>
                </div>
            </section>
            

            <!-- Skill Matrix Section -->
            <section id="skill-matrix-section" class="content-section hidden">
                <div class="section-header">
                    <h2>üìä Skill Matrix</h2>
                    <!-- Update section-controls di skill matrix -->
                    <div class="section-controls">
                        <div class="filter-group">
                            <label for="skillMatrixModeSelect">Mode:</label>
                            <select id="skillMatrixModeSelect" onchange="handleSkillMatrixModeChange()">
                                <option value="comp-assy">Comp Assy (47 Skill)</option>
                                <option value="comp-wclutch">Comp WClutch (12 Skill)</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label class="filter-label">Line</label>
                            <select id="skillMatrixLineFilter" onchange="filterSkillMatrixData()">
                                <option value="all">Semua Line</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label class="filter-label">Cari MP</label>
                            <input type="text" id="skillMatrixSearch" placeholder="Cari MP Assy atau MP WClutch..." oninput="smartSearchMP()">
                        </div>
                        <div class="filter-group button-group-horizontal">
                            <button class="btn btn-primary" onclick="openSkillMatrixModal()">+ Tambah Evaluasi</button>
                            <button class="btn btn-success" onclick="exportSkillMatrixToCSV()">
                                <span>üìä</span> Export CSV
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="skill-matrix-container">
                    <table id="skillMatrixTable" class="data-table">
                        <thead>
                            <tr>
                                <th class="sortable" onclick="toggleSkillMatrixNPKSort()">NPK <span id="skill-matrix-sort-indicator">‚Üë</span></th>
                                <th>Nama</th>
                                <th>Section</th>
                                <th>Line</th>
                                <th>Pos Saat Ini</th>
                                <th>Mizusumashi Towing</th>
                                <th>Mizusumashi Shaft</th>
                                <th>Pre Check</th>
                                <th>Part Washing Big Part (IN)</th>
                                <th>Part Washing Inner Part (IN)</th>
                                <th>Pass Room (Prepare Piston)</th>
                                <th>Pass Room (Prepare Gasket) </th>
                                <th>Prepare Thrust Bearing</th>
                                <th>Prepare Oring PRV</th>
                                <th>Bearing Assy</th>
                                <th>Bushing Assy</th>
                                <th>Mizusumashi Assy</th>
                                <th>Part Washing Inner Part (OUT) LIP Seal Assy</th>
                                <th>Part Washing Inner Part (OUT)</th>
                                <th>PRV Assy</th>
                                <th>Piston & Swash Measuring</th>
                                <th>Shoe Selecting</th>
                                <th>Cylinder Block Assy</th>
                                <th>Shoe Clearance & Muffler Bolt</th>
                                <th>QR Code Label Assy & Press Pin</th>
                                <th>Frint Side Assy</th>
                                <th>Front Houing Assy</th>
                                <th>Rear Housing Assy</th>
                                <th>Housing Bolt</th>
                                <th>Bolt Tightening</th>
                                <th>Concentricity Check & Torque Check</th>
                                <th>Empty Weight & Dummy Assy</th>
                                <th>Vacuum & Gas Charging</th>
                                <th>Helium Leak Test</th>
                                <th>High Pressure Check</th>
                                <th>Performance Test</th>
                                <th>Release Dummy</th>
                                <th>Pre Oil & Oil Filling</th>
                                <th>Seal Cap Assy</th>
                                <th>Flange Assy</th>
                                <th>Air Leak Test</th>
                                <th>Gas Release</th>
                                <th>Seal Cap Assy 2</th>
                                <th>Final Washing</th>
                                <th>Name Plate Assy</th>
                                <th>Thermal Sensor</th>
                                <th>Felt Assy</th>
                                <th>Foot & Boshi Check</th>
                                <th>Robot Final Check</th>
                                <th>Taking & Laser Name Plate</th>
                                <th>Repair Shoe Clearance</th>
                                <th>Repair Dipping</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody id="skillMatrixTableBody">
                            <!-- Data akan diisi oleh JavaScript -->
                        </tbody>
                    </table>
                </div>
            </section>
            </section>
            <script src="js/script.js"></script>
            <script>
                // Set browser info - tunggu sampai DOM ready
                document.addEventListener('DOMContentLoaded', function() {
                    const browserInfoElement = document.getElementById('browser-info');
                    if (browserInfoElement) {
                        browserInfoElement.textContent = navigator.userAgent.split(' ').pop();
                    }
                });
            </script>
            
            <!-- Di bagian mapping section, hapus filter proses dan tambahkan charts -->
            <section id="mapping-section" class="content-section hidden">
                <div class="section-header">
                    <h2>üó∫Ô∏è Mapping Manpower</h2>
                </div>
                
                <!-- Tambahkan container untuk charts -->
                <div class="charts-container" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 20px; border-radius: 12px; box-shadow: 0 8px 32px rgba(0,0,0,0.1); margin-bottom: 20px;">
                    <div class="chart-row" style="display: flex; gap: 20px; align-items: stretch;">
                        <!-- Comp Assy Chart - Left Side -->
                        <div class="chart-item" style="flex: 1; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 4px 8px rgba(0,0,0,0.1);">
                            <canvas id="mappingCompAssyChart" width="300" height="350"></canvas>
                        </div>
                        
                        <!-- Comp WClutch Chart - Right Side -->
                        <div class="chart-item" style="flex: 1; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 4px 8px rgba(0,0,0,0.1);">
                            <canvas id="mappingCompWClutchChart" width="300" height="350"></canvas>
                        </div>
                    </div>
                </div>
                
                <div class="table-container">
                    <!-- Perbaiki struktur filter di mapping (sekitar baris 620-640) -->
                    <div class="table-header">
                        <div class="button-group">
                            <button class="btn btn-success" onclick="exportMappingToCSV()">
                                <span>üìä</span> Export CSV
                            </button>
                            <div class="filter-group">
                                <label for="mappingSectionFilter">üè≠ Filter Section:</label>
                                <select id="mappingSectionFilter" onchange="updateMappingLineFilter(); filterMappingData()">
                                    <option value="">Semua Section</option>
                                    <!-- Options akan diisi oleh JavaScript -->
                                </select>
                            </div>
                            <div class="filter-group">
                                <label for="mappingLineFilter">üîß Filter Line:</label>
                                <select id="mappingLineFilter" onchange="filterMappingData()">
                                    <option value="">Semua Line</option>
                                    <!-- Options akan diisi oleh JavaScript -->
                                </select>
                            </div>
                        </div>
                        <div class="search-box">
                            <input type="text" placeholder="       Cari data mapping..." id="mappingSearchInput" oninput="filterMappingData()">
                        </div>
                    </div>
                    <table id="mappingTable">
                        <thead>
                            <tr>
                                <th>No</th>
                                <th class="sortable" onclick="toggleMappingNPKSort()">NPK <span id="mapping-sort-indicator">‚Üë</span></th>
                                <th>Name</th>
                                <th>Section</th>
                                <th>Line</th>
                                <th>Leader</th>
                                <th>Proses</th>
                                <th>Raport</th>
                            </tr>
                        </thead>
                        <tbody id="mappingTableBody">
                            <!-- Data akan diisi oleh JavaScript -->
                        </tbody>
                    </table>
                </div>
                <div class="pagination-container">
                    <div id="mappingPagination" class="pagination"></div>
                </div>
            </section>

            <!-- Settings Section -->
            <section id="settings-section" class="content-section hidden">
                <div class="section-header">
                    <h2>Pengaturan Sistem</h2>
                </div>
                <div class="table-container">
                    <div class="settings-grid">
                        <!-- Data Management -->
                        <div class="settings-card">
                            <h3>üìÇ Data Management</h3>
                            <p>Kelola backup dan restore data sistem</p>
                            <div class="settings-actions">
                                <button class="btn btn-primary" onclick="exportAllData()">
                                    <span>üíæ</span> Backup Semua Data
                                </button>
                                <label class="btn btn-success" for="import-file">
                                    <span>üìÅ</span> Restore Data
                                    <input type="file" id="import-file" accept=".json" style="display: none;" onchange="importData(event)">
                                </label>
                                <button class="btn btn-warning" onclick="exportToCSV()">
                                    <span>üìä</span> Export CSV
                                </button>
                            </div>
                        </div>

                        <!-- Storage Info -->
                        <div class="settings-card">
                            <h3>üíø Storage Information</h3>
                            <p>Informasi penggunaan localStorage browser</p>
                            <div class="storage-info" id="storage-info">
                                <div class="info-item">
                                    <span class="info-label">Total Karyawan:</span>
                                    <span class="info-value" id="total-employees">0</span>
                                </div>
                                <div class="info-item">
                                    <span class="info-label">Total Records:</span>
                                    <span class="info-value" id="total-records">0</span>
                                </div>
                                <div class="info-item">
                                    <span class="info-label">Storage Used:</span>
                                    <span class="info-value" id="storage-used">0 KB</span>
                                </div>
                            </div>
                            <button class="btn btn-primary" onclick="updateStorageInfo()">
                                <span>üîÑ</span> Refresh Info
                            </button>
                        </div>

                        <!-- Quick Actions -->
                        <div class="settings-card">
                            <h3>‚ö° Quick Actions</h3>
                            <p>Aksi cepat untuk produktivitas</p>
                            <div class="settings-actions">
                                <button class="btn btn-primary" onclick="openModal('add')">
                                    <span>üë•</span> Tambah Karyawan
                                </button>
                                <button class="btn btn-success" onclick="openModal('recruitment')">
                                    <span>üéØ</span> Tambah Kandidat
                                </button>
                                <button class="btn btn-warning" onclick="openModal('education')">
                                    <span>üéì</span> Tambah Program
                                </button>
                            </div>
                        </div>

                        <!-- Keyboard Shortcuts -->
                        <div class="settings-card">
                            <h3>‚å®Ô∏è Keyboard Shortcuts</h3>
                            <div class="shortcuts-list">
                                <div class="shortcut-item">
                                    <kbd>Ctrl + N</kbd>
                                    <span>Tambah Karyawan Baru</span>
                                </div>
                                <div class="shortcut-item">
                                    <kbd>Ctrl + E</kbd>
                                    <span>Export CSV</span>
                                </div>
                                <div class="shortcut-item">
                                    <kbd>Ctrl + B</kbd>
                                    <span>Backup Data</span>
                                </div>
                                <div class="shortcut-item">
                                    <kbd>Ctrl + S</kbd>
                                    <span>Simpan Form (dalam modal)</span>
                                </div>
                                <div class="shortcut-item">
                                    <kbd>Escape</kbd>
                                    <span>Tutup Modal</span>
                                </div>
                            </div>
                        </div>

                        <!-- System Info -->
                        <div class="settings-card">
                            <h3>‚ÑπÔ∏è System Information</h3>
                            <div class="storage-info">
                                <div class="info-item">
                                    <span class="info-label">Version:</span>
                                    <span class="info-value">1.0.0</span>
                                </div>
                                <div class="info-item">
                                    <span class="info-label">Storage Type:</span>
                                    <span class="info-value">localStorage</span>
                                </div>
                                <div class="info-item">
                                    <span class="info-label">Browser:</span>
                                    <span class="info-value" id="browser-info">Loading...</span>
                                </div>
                            </div>
                        </div>

                        <!-- Danger Zone -->
                        <div class="settings-card danger-zone">
                            <h3>‚ö†Ô∏è Danger Zone</h3>
                            <p>Area berbahaya - gunakan dengan hati-hati!</p>
                            <div class="settings-actions">
                                <button class="btn btn-danger" onclick="clearAllData()">
                                    <span>üóëÔ∏è</span> Reset Semua Data
                                </button>
                            </div>
                            <small style="color: #e74c3c; display: block; margin-top: 10px;">
                                ‚ö†Ô∏è Tindakan ini tidak dapat dibatalkan!
                            </small>
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Universal Modal -->
    <div id="modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modal-title">Form Input</h3>
                <button class="close" onclick="closeModal()">&times;</button>
            </div>
            <div class="modal-body">
                <!-- Form content will be dynamically generated -->
            </div>
            <div class="modal-footer">
                <button class="btn btn-primary" onclick="saveData()">
                    <span>üíæ</span> Simpan
                </button>
                <button class="btn" onclick="closeModal()" style="background: #95a5a6; color: white;">
                    <span>‚ùå</span> Batal
                </button>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-content">
            <div class="footer-info">
                <p>üè≠ MP Development Management System By A Alfin 2025</p>
            </div>
    </footer>